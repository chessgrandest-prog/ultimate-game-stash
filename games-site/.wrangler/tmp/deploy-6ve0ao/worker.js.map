{
  "version": 3,
  "sources": ["../../../src/worker.js"],
  "sourceRoot": "C:\\Users\\Vaylo\\Downloads\\fun\\ultimate-game-stash\\games-site\\.wrangler\\tmp\\deploy-6ve0ao",
  "sourcesContent": ["export default {\r\n  async fetch(request, env) {\r\n    const url = new URL(request.url);\r\n\r\n    // 1\uFE0F\u20E3 Serve static assets from ASSETS first\r\n    const assetResponse = await env.ASSETS.fetch(request);\r\n    if (assetResponse.status !== 404) return assetResponse;\r\n\r\n    // 2\uFE0F\u20E3 Serve Terraria files from GitHub\r\n    if (url.pathname.startsWith(\"/terraria/\")) {\r\n      const githubUrl = `https://chessgrandest-prog.github.io/terraria-wasm1${url.pathname.replace(\"/terraria\", \"\")}`;\r\n      const res = await fetch(githubUrl);\r\n\r\n      if (!res.ok) return new Response(\"Terraria file not found\", { status: 404 });\r\n\r\n      const headers = new Headers(res.headers);\r\n      headers.set(\"Cross-Origin-Embedder-Policy\", \"require-corp\");\r\n      headers.set(\"Cross-Origin-Opener-Policy\", \"same-origin\");\r\n\r\n      return new Response(res.body, { status: res.status, headers });\r\n    }\r\n\r\n    // 3\uFE0F\u20E3 Serve games+img.json with pagination, search, favorites\r\n    if (url.pathname === \"/games+img.json\") {\r\n      try {\r\n        const gamesRes = await env.ASSETS.fetch(new Request(`${env.ASSETS.url}/games+img.json`));\r\n        if (!gamesRes.ok) throw new Error(\"Failed to fetch games JSON\");\r\n\r\n        let games = await gamesRes.json();\r\n\r\n        const page = parseInt(url.searchParams.get(\"page\") || \"1\");\r\n        const limit = parseInt(url.searchParams.get(\"limit\") || \"50\");\r\n        const searchQuery = (url.searchParams.get(\"search\") || \"\").toLowerCase();\r\n        const favoritesOnly = url.searchParams.get(\"favorites\") === \"1\";\r\n        const favoriteGames = JSON.parse(url.searchParams.get(\"favList\") || \"[]\");\r\n\r\n        // Filter by search\r\n        if (searchQuery) games = games.filter(g => g.title.toLowerCase().includes(searchQuery));\r\n\r\n        // Filter by favorites\r\n        if (favoritesOnly) games = games.filter(g => favoriteGames.includes(g.url));\r\n\r\n        const total = games.length;\r\n        const start = (page - 1) * limit;\r\n        const paginatedGames = games.slice(start, start + limit);\r\n\r\n        const headers = new Headers({\r\n          \"Content-Type\": \"application/json; charset=UTF-8\",\r\n          \"Cross-Origin-Embedder-Policy\": \"require-corp\",\r\n          \"Cross-Origin-Opener-Policy\": \"same-origin\"\r\n        });\r\n\r\n        return new Response(JSON.stringify({ total, page, limit, games: paginatedGames }), { headers });\r\n      } catch (err) {\r\n        console.error(\"[Worker] Error loading games JSON:\", err);\r\n        return new Response(JSON.stringify({ total: 0, page: 1, limit: 50, games: [] }), {\r\n          headers: {\r\n            \"Content-Type\": \"application/json; charset=UTF-8\",\r\n            \"Cross-Origin-Embedder-Policy\": \"require-corp\",\r\n            \"Cross-Origin-Opener-Policy\": \"same-origin\"\r\n          },\r\n          status: 500\r\n        });\r\n      }\r\n    }\r\n\r\n    // 4\uFE0F\u20E3 Fallback for everything else\r\n    return new Response(\"Not Found\", { status: 404 });\r\n  }\r\n};\r\n"],
  "mappings": ";AAAA,IAAO,iBAAQ;AAAA,EACb,MAAM,MAAM,SAAS,KAAK;AACxB,UAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAG/B,UAAM,gBAAgB,MAAM,IAAI,OAAO,MAAM,OAAO;AACpD,QAAI,cAAc,WAAW,IAAK,QAAO;AAGzC,QAAI,IAAI,SAAS,WAAW,YAAY,GAAG;AACzC,YAAM,YAAY,sDAAsD,IAAI,SAAS,QAAQ,aAAa,EAAE,CAAC;AAC7G,YAAM,MAAM,MAAM,MAAM,SAAS;AAEjC,UAAI,CAAC,IAAI,GAAI,QAAO,IAAI,SAAS,2BAA2B,EAAE,QAAQ,IAAI,CAAC;AAE3E,YAAM,UAAU,IAAI,QAAQ,IAAI,OAAO;AACvC,cAAQ,IAAI,gCAAgC,cAAc;AAC1D,cAAQ,IAAI,8BAA8B,aAAa;AAEvD,aAAO,IAAI,SAAS,IAAI,MAAM,EAAE,QAAQ,IAAI,QAAQ,QAAQ,CAAC;AAAA,IAC/D;AAGA,QAAI,IAAI,aAAa,mBAAmB;AACtC,UAAI;AACF,cAAM,WAAW,MAAM,IAAI,OAAO,MAAM,IAAI,QAAQ,GAAG,IAAI,OAAO,GAAG,iBAAiB,CAAC;AACvF,YAAI,CAAC,SAAS,GAAI,OAAM,IAAI,MAAM,4BAA4B;AAE9D,YAAI,QAAQ,MAAM,SAAS,KAAK;AAEhC,cAAM,OAAO,SAAS,IAAI,aAAa,IAAI,MAAM,KAAK,GAAG;AACzD,cAAM,QAAQ,SAAS,IAAI,aAAa,IAAI,OAAO,KAAK,IAAI;AAC5D,cAAM,eAAe,IAAI,aAAa,IAAI,QAAQ,KAAK,IAAI,YAAY;AACvE,cAAM,gBAAgB,IAAI,aAAa,IAAI,WAAW,MAAM;AAC5D,cAAM,gBAAgB,KAAK,MAAM,IAAI,aAAa,IAAI,SAAS,KAAK,IAAI;AAGxE,YAAI,YAAa,SAAQ,MAAM,OAAO,OAAK,EAAE,MAAM,YAAY,EAAE,SAAS,WAAW,CAAC;AAGtF,YAAI,cAAe,SAAQ,MAAM,OAAO,OAAK,cAAc,SAAS,EAAE,GAAG,CAAC;AAE1E,cAAM,QAAQ,MAAM;AACpB,cAAM,SAAS,OAAO,KAAK;AAC3B,cAAM,iBAAiB,MAAM,MAAM,OAAO,QAAQ,KAAK;AAEvD,cAAM,UAAU,IAAI,QAAQ;AAAA,UAC1B,gBAAgB;AAAA,UAChB,gCAAgC;AAAA,UAChC,8BAA8B;AAAA,QAChC,CAAC;AAED,eAAO,IAAI,SAAS,KAAK,UAAU,EAAE,OAAO,MAAM,OAAO,OAAO,eAAe,CAAC,GAAG,EAAE,QAAQ,CAAC;AAAA,MAChG,SAAS,KAAK;AACZ,gBAAQ,MAAM,sCAAsC,GAAG;AACvD,eAAO,IAAI,SAAS,KAAK,UAAU,EAAE,OAAO,GAAG,MAAM,GAAG,OAAO,IAAI,OAAO,CAAC,EAAE,CAAC,GAAG;AAAA,UAC/E,SAAS;AAAA,YACP,gBAAgB;AAAA,YAChB,gCAAgC;AAAA,YAChC,8BAA8B;AAAA,UAChC;AAAA,UACA,QAAQ;AAAA,QACV,CAAC;AAAA,MACH;AAAA,IACF;AAGA,WAAO,IAAI,SAAS,aAAa,EAAE,QAAQ,IAAI,CAAC;AAAA,EAClD;AACF;",
  "names": []
}
